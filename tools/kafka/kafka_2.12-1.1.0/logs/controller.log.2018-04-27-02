[2018-04-27 06:31:15,494] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2018-04-27 06:31:15,502] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2, 0) (kafka.controller.KafkaController)
[2018-04-27 06:31:15,515] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-27 06:31:15,524] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-27 06:31:15,538] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,538] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,538] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,544] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,546] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,546] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-27 06:31:15,554] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2018-04-27 06:31:16,549] ERROR [ControllerEventThread controllerId=2] Error processing event RegisterBrokerAndReelect (kafka.controller.ControllerEventManager$ControllerEventThread)
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:119)
	at kafka.zk.KafkaZkClient.checkedEphemeralCreate(KafkaZkClient.scala:1476)
	at kafka.zk.KafkaZkClient.registerBrokerInZk(KafkaZkClient.scala:84)
	at kafka.controller.KafkaController$RegisterBrokerAndReelect$.process(KafkaController.scala:1487)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:69)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:69)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2018-04-27 06:31:17,362] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2018-04-27 06:31:17,362] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2018-04-27 06:31:17,362] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-27 06:31:17,362] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-27 06:31:17,362] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2018-04-27 06:31:17,374] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
