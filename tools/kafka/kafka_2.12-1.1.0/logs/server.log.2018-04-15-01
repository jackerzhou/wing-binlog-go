[2018-04-15 01:36:56,212] INFO [Partition testtopic1-0 broker=0] Shrinking ISR from 0,1,2 to 0 (kafka.cluster.Partition)
[2018-04-15 01:36:56,776] INFO [ReplicaFetcher replicaId=0, leaderId=2, fetcherId=0] Error sending fetch request (sessionId=1428693725, epoch=2641) to node 2: java.io.IOException: Connection to 2 was disconnected before the response was read. (org.apache.kafka.clients.FetchSessionHandler)
[2018-04-15 01:36:56,775] INFO [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Error sending fetch request (sessionId=852015840, epoch=2642) to node 1: java.io.IOException: Connection to 1 was disconnected before the response was read. (org.apache.kafka.clients.FetchSessionHandler)
[2018-04-15 01:36:56,213] WARN Client session timed out, have not heard from server in 3389423ms for sessionid 0x200163c8e180003 (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:36:57,052] INFO Client session timed out, have not heard from server in 3389423ms for sessionid 0x200163c8e180003, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:36:57,071] WARN [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=0, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={}, isolationLevel=READ_UNCOMMITTED, toForget=, metadata=(sessionId=852015840, epoch=2642)) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:97)
	at kafka.server.ReplicaFetcherBlockingSend.sendRequest(ReplicaFetcherBlockingSend.scala:96)
	at kafka.server.ReplicaFetcherThread.fetch(ReplicaFetcherThread.scala:220)
	at kafka.server.ReplicaFetcherThread.fetch(ReplicaFetcherThread.scala:43)
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:146)
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2018-04-15 01:36:57,211] INFO [ZooKeeperClient] Waiting until connected. (kafka.zookeeper.ZooKeeperClient)
[2018-04-15 01:36:57,263] INFO [ZooKeeperClient] Connected. (kafka.zookeeper.ZooKeeperClient)
[2018-04-15 01:36:57,071] WARN [ReplicaFetcher replicaId=0, leaderId=2, fetcherId=0] Error in response for fetch request (type=FetchRequest, replicaId=0, maxWait=500, minBytes=1, maxBytes=10485760, fetchData={}, isolationLevel=READ_UNCOMMITTED, toForget=, metadata=(sessionId=1428693725, epoch=2641)) (kafka.server.ReplicaFetcherThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:97)
	at kafka.server.ReplicaFetcherBlockingSend.sendRequest(ReplicaFetcherBlockingSend.scala:96)
	at kafka.server.ReplicaFetcherThread.fetch(ReplicaFetcherThread.scala:220)
	at kafka.server.ReplicaFetcherThread.fetch(ReplicaFetcherThread.scala:43)
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:146)
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:111)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2018-04-15 01:36:57,928] INFO Opening socket connection to server 127.0.0.1/127.0.0.1:12183. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:36:57,928] INFO Socket connection established to 127.0.0.1/127.0.0.1:12183, initiating session (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:36:57,933] INFO Session establishment complete on server 127.0.0.1/127.0.0.1:12183, sessionid = 0x200163c8e180003, negotiated timeout = 6000 (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:36:57,980] INFO [Partition testtopic4-0 broker=0] Shrinking ISR from 0,2,1 to 0 (kafka.cluster.Partition)
[2018-04-15 01:36:57,984] INFO [Partition testtopic5-2 broker=0] Shrinking ISR from 0,2,1 to 0 (kafka.cluster.Partition)
[2018-04-15 01:36:59,093] INFO [Partition testtopic5-2 broker=0] Expanding ISR from 0 to 0,1 (kafka.cluster.Partition)
[2018-04-15 01:36:59,095] INFO [Partition testtopic4-0 broker=0] Expanding ISR from 0 to 0,1 (kafka.cluster.Partition)
[2018-04-15 01:36:59,097] INFO [Partition testtopic1-0 broker=0] Expanding ISR from 0 to 0,1 (kafka.cluster.Partition)
[2018-04-15 01:36:59,467] INFO [Partition testtopic5-2 broker=0] Expanding ISR from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2018-04-15 01:36:59,473] INFO [Partition testtopic4-0 broker=0] Expanding ISR from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2018-04-15 01:36:59,476] INFO [Partition testtopic1-0 broker=0] Expanding ISR from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2018-04-15 01:37:04,843] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions testtopic5-1 (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,843] INFO [Partition testtopic5-1 broker=0] testtopic5-1 starts at Leader Epoch 3 from offset 0. Previous Leader Epoch was: 2 (kafka.cluster.Partition)
[2018-04-15 01:37:04,844] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions mytopic-0 (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,844] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([mytopic-0, initOffset 7 to broker BrokerEndPoint(2,localhost,9094)] ) (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,845] INFO [ReplicaAlterLogDirsManager on broker 0] Added fetcher for partitions List() (kafka.server.ReplicaAlterLogDirsManager)
[2018-04-15 01:37:04,845] INFO [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Shutting down (kafka.server.ReplicaFetcherThread)
[2018-04-15 01:37:04,855] INFO [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Error sending fetch request (sessionId=926116969, epoch=9) to node 1: java.nio.channels.ClosedSelectorException. (org.apache.kafka.clients.FetchSessionHandler)
[2018-04-15 01:37:04,855] INFO [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)
[2018-04-15 01:37:04,857] INFO [ReplicaFetcher replicaId=0, leaderId=1, fetcherId=0] Shutdown completed (kafka.server.ReplicaFetcherThread)
[2018-04-15 01:37:04,858] INFO [ReplicaFetcher replicaId=0, leaderId=2, fetcherId=0] Based on follower's leader epoch, leader replied with an offset 7 >= the follower's log end offset 7 in mytopic-0. No truncation needed. (kafka.server.ReplicaFetcherThread)
[2018-04-15 01:37:04,858] INFO [Log partition=mytopic-0, dir=/Users/yuyi/Code/go/wing-binlog-go/tools/kafka/logs] Truncating to 7 has no effect as the largest offset in the log is 6 (kafka.log.Log)
[2018-04-15 01:37:04,901] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions testtopic5-2,testtopic4-0,testtopic1-0 (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,902] INFO [Partition testtopic5-2 broker=0] testtopic5-2 starts at Leader Epoch 1 from offset 0. Previous Leader Epoch was: 0 (kafka.cluster.Partition)
[2018-04-15 01:37:04,905] INFO [Partition testtopic4-0 broker=0] testtopic4-0 starts at Leader Epoch 1 from offset 0. Previous Leader Epoch was: 0 (kafka.cluster.Partition)
[2018-04-15 01:37:04,906] INFO [Partition testtopic1-0 broker=0] testtopic1-0 starts at Leader Epoch 1 from offset 0. Previous Leader Epoch was: 0 (kafka.cluster.Partition)
[2018-04-15 01:37:04,908] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,908] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2018-04-15 01:37:04,908] INFO [ReplicaAlterLogDirsManager on broker 0] Added fetcher for partitions List() (kafka.server.ReplicaAlterLogDirsManager)
[2018-04-15 01:37:05,142] INFO [Partition testtopic5-2 broker=0] Expanding ISR from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2018-04-15 01:37:05,145] INFO [Partition testtopic4-0 broker=0] Expanding ISR from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2018-04-15 01:37:05,147] INFO [Partition testtopic1-0 broker=0] Expanding ISR from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2018-04-15 01:42:40,212] WARN Client session timed out, have not heard from server in 293427ms for sessionid 0x200163c8e180003 (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:42:40,700] INFO Client session timed out, have not heard from server in 293427ms for sessionid 0x200163c8e180003, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:42:40,213] INFO [Partition testtopic1-0 broker=0] Shrinking ISR from 0,2,1 to 0 (kafka.cluster.Partition)
[2018-04-15 01:42:40,805] INFO [ZooKeeperClient] Waiting until connected. (kafka.zookeeper.ZooKeeperClient)
[2018-04-15 01:42:40,805] INFO [ZooKeeperClient] Connected. (kafka.zookeeper.ZooKeeperClient)
[2018-04-15 01:42:41,504] INFO Opening socket connection to server 127.0.0.1/127.0.0.1:12182. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:42:41,505] INFO Socket connection established to 127.0.0.1/127.0.0.1:12182, initiating session (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:42:41,507] INFO Session establishment complete on server 127.0.0.1/127.0.0.1:12182, sessionid = 0x200163c8e180003, negotiated timeout = 6000 (org.apache.zookeeper.ClientCnxn)
[2018-04-15 01:42:41,513] INFO [Partition testtopic1-0 broker=0] Expanding ISR from 0 to 0,2 (kafka.cluster.Partition)
[2018-04-15 01:42:41,513] INFO [Partition testtopic5-1 broker=0] Shrinking ISR from 0,2 to 0 (kafka.cluster.Partition)
[2018-04-15 01:42:41,517] INFO [Partition testtopic5-1 broker=0] Expanding ISR from 0 to 0,2 (kafka.cluster.Partition)
[2018-04-15 01:42:41,517] INFO [Partition testtopic1-0 broker=0] Expanding ISR from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2018-04-15 01:43:04,179] INFO [GroupMetadataManager brokerId=0] Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
